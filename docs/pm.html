<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- No caching headers -->
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="pragma" content="no-cache"/>
    <meta http-equiv="expires" content="-1"/>
    <meta name="keywords" content="JDO, Apache, Java, Data, Objects"/>
    <meta name="description" content="Apache JDO - Java Data Objects"/>

    <title>JDO TEST</title>

    <link rel="icon" type="image/png" href="https://tzaeschke.github.io/test-jdo-asciidoc/images/JDO_32x32.png"/>

    <!--
        Apache JDO Documentation Template
        ==================================
        This template derived various aspects from Apache Deltaspike template, the Apache ISIS template and the Datanucleus template.
        This template uses 
        * Bootstrap v3.3.7 (https://getbootstrap.com/) for navbar.
        * Asciidoctor "foundation" CSS
        * Bootswatch "cosmo" theme for Bootstrap (https://bootswatch.com/cosmo).
        * Bootstrap TOC plugin v0.4.1 (https://afeld.github.io/bootstrap-toc/) for the table of contents.
        * jQuery (necessary for Bootstrap's JavaScript plugins)
        * Font-Awesome for some icons used by Asciidoctor
        NOTE: tried using Font-Awesome CSS hosted locally but then fails to work!
    -->
    <link href="css/bootswatch/3.3.7/bootstrap-cosmo.css" rel="stylesheet"/>
    <link href="css/bootstrap-toc/0.4.1/bootstrap-toc.min.css" rel="stylesheet"/>

    <link href="css/asciidoctor/foundation.css" rel="stylesheet"/>
    <link href="css/datanucleus_theme.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    

    

    
    
    

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="js/bootstrap/3.3.7/bootstrap.min.js"></script>
    <script src="js/bootstrap-toc/0.4.1/bootstrap-toc.min.js"></script>

    <!-- Coderay syntax formatter -->
    <style type="text/css">
        /* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
    </style>
</head>
<body data-spy="scroll" data-target="#toc">
<!-- Navbar -->
<nav class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <!-- Three line menu button for use on mobile screens -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- 'style' added to align image with navbar. FIX THIS -->
            <a class="navbar-brand" href="https://db.apache.org/jdo/">
                <img style="margin-top: -12px;" alt="Brand" src="images/JDO_44x44.png"/>
            </a>
            <!-- TODO Any way to abstract the version from Maven? -->
            <a class="navbar-brand" href="index.html">Apache JDO</a>
            <!-- 'style' added to fix height of input box. FIX THIS -->
            <form class="navbar-form navbar-left" role="search" id="search-form" action="https://www.google.com/search" method="get" style="padding: 1px 15px;">
                <div class="form-group">
                    <input name="sitesearch" value="db.apache.org" type="hidden">
                    <input name="q" type="text" class="form-control" placeholder="Search" style="margin-top: 7px; padding: 1px; border-radius: 5px; height: 30px; vertical-align: middle;">
                </div>
            </form>
        </div>
        <!-- Navbar that will collapse on mobile screens -->
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="dropdown">
                  
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">General <span class="caret"></span></a>
                  
                    <ul class="dropdown-menu">
                        <li><a href="why_jdo.html">Why JDO?</a></li>
                        <li><a href="jdo_v_jpa.html">JDO v JPA</a></li>
                        <li><a href="jdo_v_jpa_api.html">JDO v JPA : API</a></li>
                        <li><a href="jdo_v_jpa_orm.html">JDO v JPA : ORM</a></li>
                        <li><a href="downloads.html">Downloads</a></li>
                        <li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                  
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">JDO Implementation <span class="caret"></span></a>
                  
                    <ul class="dropdown-menu">
                        <li><a href="specifications.html">Specifications</a></li>
                        <li><a href="tck.html">TCK</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                  
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">JDO Usage <span class="caret"></span></a>
                  
                    <ul class="dropdown-menu">
                        <li><a href="impls.html">Implementations</a></li>
                        <li><a href="javadoc.html">API Javadoc</a></li>
                        <li><a href="class_types.html">Types of Classes</a></li>
                        <li><a href="field_types.html">Types of Fields</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">Metadata</li>
                        <li><a href="metadata.html">MetaData</a></li>
                        <li><a href="annotations.html">Annotations</a></li>
                        <li><a href="jdo_dtd.html">jdo DTD/XSD</a></li>
                        <li><a href="orm_dtd.html">orm DTD/XSD</a></li>
                        <li><a href="jdoquery_dtd.html">jdoquery DTD/XSD</a></li>
                        <li><a href="jdoconfig_dtd.html">jdoconfig DTD/XSD</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="enhancement.html">Bytecode Enhancement</a></li>
                        <li><a href="jdohelper.html">JDO Helper</a></li>
                    </ul>
                </li>
                <li><a href="jdo_3_0_overview.html">Articles</a></li>
                <li><a href="extensions/extensions.html">Community</a></li>
                <li><a href="extensions/extensions.html">Development</a></li>
            </ul>
        </div>
    </div>
</nav>
<div class="container">
    
        <div class="row-fluid">
            <div class="col-sm-9">
                <div class="page-title">
                    <h1>JDO TEST</h1>
                </div>
                <div id="doc-content">
                    <div id="index" class="imageblock" style="text-align: center">
<div class="content">
<img src="images/JDOx150.png" alt="JDOx150">
</div>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/jdo_text.png" alt="jdo text">
</div>
</div>
<div class="sect1">
<h2 id="_jdo_test">JDO TEST</h2>
<div class="sectionbody">
<hr>
<div class="sect2">
<h3 id="_persistence_manager_a_id_persistence_manager_a">Persistence Manager<a id="Persistence_Manager"></a></h3>
<div class="paragraph">
<p>Any JDO-enabled application will require at least one
<em>PersistenceManager</em> (PM). This is obtained from the
<a href="pmf.adoc">PersistenceManagerFactory</a> for the datastore.</p>
</div>
<div class="paragraph">
<p>The simplest way of creating a <em>PersistenceManager</em>
<a href="api20/apidocs/javax/jdo/PersistenceManager.adoc"><span class="image"><img src="images/javadoc.png" alt="image"></span></a>
is as follows</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PersistenceManagerFactory pmf = JDOHelper.getPersistenceManagerFactory(props);
PersistenceManager pm = pmf.getPersistenceManager();</pre>
</div>
</div>
<div class="paragraph">
<p>A <em>PersistenceManager</em> is the key to all persistence operations in JDO.
With it you can persist, update, delete, and retrieve objects from the
datastore. A <em>PersistenceManager</em> has a single transaction.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="sect3">
<h4 id="_persist_objects_a_id_persist_objects_a">Persist Objects<a id="Persist_Objects"></a></h4>
<div class="paragraph">
<p>To persist an object, the object must first be marked as persistable
using <a href="metadata.adoc">MetaData (XML/Annotations)</a>. Then you would
start the PM transaction, and use <em>makePersistent</em> as follows</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PersistenceManager pm = pmf.getPersistenceManager();
Transaction tx = pm.currentTransaction();
try
{
    // Start the transaction
    tx.begin();

    // Create the object to persist
    MyClass obj = new MyClass();

    // Persist it to the datastore
    pm.makePersistent(obj);

    // Commit the transaction, flushing the object to the datastore
    tx.commit();
}
catch (Exception e)
{
    ... handle exceptions
}
finally
{
    if (tx.isActive())
    {
        // Error occurred so rollback the transaction
        tx.rollback();
    }
    pm.close();
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>makePersistent</em> method of <strong>PersistenceManager</strong> makes the object
persistent in the datastore, and updates the 'state' of the object from
<em>Transient</em> (at the start) to <em>Hollow</em> (after commit() of the
transaction).</p>
</div>
<div class="paragraph">
<p>When an object is persisted, if it has any other objects referenced from
that object they also will be made persistent. This is referred to as
<strong>persistence-by-reachability</strong>. The main benefit of this is that if you
have an object graph to persist, then you don&#8217;t need to call
<em>makePersistent()</em> on all objects, instead just using one that can be
used to find all of the others. <strong>persistence-by-reachability</strong> is also
run at the time of calling <em>commit()</em> on the transaction. This has the
effect that if you had called <em>makePersistent()</em> on an object and that
had persisted another object, and before commit you had removed the
relation to this other object, then at <em>commit()</em> the reachability
algorithm will find that this other object is no longer reachable and
will remove it from persistence.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
</div>
<div class="sect3">
<h4 id="_retrieve_objects_a_id_retrieve_objects_a">Retrieve Objects<a id="Retrieve_Objects"></a></h4>
<div class="paragraph">
<p>So we&#8217;ve made some of our objects persistent, and now we want to
retrieve them in our application. Here&#8217;s one way of retrieving objects
of a particular type.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>tx = pm.currentTransaction();
try
{
    tx.begin();

    Extent e = pm.getExtent(mydomain.MyClass.class, true);
    Iterator iter=e.iterator();
    while (iter.hasNext())
    {
        MyClass my_obj=(MyClass)iter.next();
        ...
    }

    tx.commit();
}
catch (Exception e)
{
    if (tx.isActive())
    {
        tx.rollback();
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>Extent</strong> interface is one of the ways to retrieve your objects. The
others use the <strong>Query</strong> interface, allowing more precise filtering over
the objects returned.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
</div>
<div class="sect3">
<h4 id="_update_objects_a_id_update_objects_a">Update Objects<a id="Update_Objects"></a></h4>
<div class="paragraph">
<p>To update an object we firstly retrieve it, as above, and then we call
any of its mutator methods. For example</p>
</div>
<div class="literalblock">
<div class="content">
<pre>tx = pm.currentTransaction();
try
{
    tx.begin();

    Extent e = pm.getExtent(mydomain.MyClass.class, true);
    Iterator iter=e.iterator();
    while (iter.hasNext())
    {
        MyClass my_obj=(MyClass)iter.next();
        my_obj.setValue(25.0); // Change the value
        ...
    }

    tx.commit();
}
catch (Exception e)
{
    if (tx.isActive())
    {
        tx.rollback();
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>When <em>setValue()</em> is called on the persistent object this change is
intercepted by JDO and the value change will be automatically sent to
the datastore &#8230;&#8203; transparently!</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
</div>
<div class="sect3">
<h4 id="_delete_objects_a_id_delete_objects_a">Delete Objects<a id="Delete_Objects"></a></h4>
<div class="paragraph">
<p>So we can persist objects, and retrieve them. Now we want to remove one
from persistence.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>try
{
    tx = pm.currentTransaction();
    tx.begin();

    ... (code to retrieve object in question) ...

    pm.deletePersistent(my_obj);

    tx.commit();
}
catch (Exception e)
{
    if (tx.isActive())
    {
        tx.rollback();
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
</div>
<div class="sect3">
<h4 id="_making_an_object_transient_a_id_making_an_object_transient_a">Making an object transient<a id="Making_an_object_transient"></a></h4>
<div class="paragraph">
<p>As we have seen in the <a href="state_transition.adoc">JDO States guide</a>, an
object can have many possible states. When we want to take an object and
work on it, but removing its identity we can make it <strong>transient</strong>. This
means that it will retain the values of its fields, yet will no longer
be associated with the object in the datastore. We do this as follows</p>
</div>
<div class="literalblock">
<div class="content">
<pre>try
{
    tx = pm.currentTransaction();
    tx.begin();

    ... (code to retrieve object in question) ...

    pm.makeTransient(my_obj);

    tx.commit();
}
catch (Exception e)
{
    if (tx.isActive())
    {
        tx.rollback();
    }
}

... (code to work on "my_obj")</pre>
</div>
</div>
<hr>
<div id="footer" class="paragraph">
<p>Copyright © 2005-2015. All Rights Reserved.</p>
</div>
<hr>
</div>
</div>
</div>
</div>
                </div>
            </div>
            <div class="col-sm-3">
                <nav id="toc" data-spy="affix" data-toggle="toc"></nav>
            </div>
        </div>
    
</div>
<footer style="background-color:#97d5ca; padding: 5px;">
<div class="container">
    <hr/>
    <div class="row">
        <div class="col-sm-9">
    <a href="https://www.facebook.com/JavaDataObjects" class="externalLink" title="Facebook">Facebook</a>
            |
                        <a href="https://twitter.com/JavaDataObjects" class="externalLink" title="Twitter">Twitter</a>
            |
                        <a href="https://plus.google.com/106584233526334524963" class="externalLink" title="Google+">Google+</a>
            |
                        <a href="http://wiki.apache.org/jdo" class="externalLink" title="Wiki">Wiki</a>
            |
                        <a href="http://issues.apache.org/jira/secure/BrowseProject.jspa?id=10630" class="externalLink" title="Issue Tracker">Issue Tracker</a>
            |
                        <a href="mail-lists.html" title="Mailing Lists">Mailing Lists</a>
            |
                        <a href="api30/apidocs/index.html" title="Latest Javadocs">Latest Javadocs</a>
        </div>
    </div>
    <hr/>
    <p class="text-center">&copy; 2005-2019 Apache Software Foundation. All Rights Reserved.</p>
</div>
</footer>
</body>
</html>